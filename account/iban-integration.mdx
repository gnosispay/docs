---
title: IBAN Integration
description: IBAN cash-in to the GnosisPay Account via Monerium
---

We offer IBAN cash-in to the GnosisPay Account via Monerium for users in Europe (EU) and Switzerland.

## Check Availability

[First you need to check if the user is available to activate their IBAN](/api-reference/iban/check-iban-availability):

```bash cURL
curl -X GET /api/v1/ibans/available
```

If you receive a `"available": false`, the flow ends here.

<Warning>
Requirements the User must have:
- An active EURe Safe Account
- KYC verified and approved
- Residency in a supported country
- Nationality from a supported country ([see allowed and restricted nationalities](https://help.gnosispay.com/en/articles/9795352-nationalities-allowed-and-restricted-for-the-iban-feature))
</Warning>

## Enabling the IBAN Integration


<Steps titleSize="h3">
<Step title="Signing the Monerium message">

Monerium requires a specific message to be signed by the User's wallet.

Get the complete EIP-712 typed data for direct wallet signing:

```bash cURL
curl -X GET /api/v1/ibans/transaction-data
```

This returns a complete EIP-712 structure that can be signed directly with any wallet using `signTypedData()`.

<Warning>
We cannot request new IBANs nor transfer existing IBANs until the message signature is completed. This signature is a mandatory requirement from Monerium to verify ownership of the address.
</Warning>
</Step>
<Step title="Request the IBAN from Monerium">

Submit the raw EIP-712 signature directly:

```bash cURL
curl -X POST /api/v1/ibans/new-profile \
-d '{
  "signature": "0x1234567890abcdef...",
  "callbackUrl": "https://your-app.com/iban-callback"
}'
```
<Warning>
**This endpoint can fail and it is expected:** Monerium only allows the user to have one single account with them. If the user already has an account, this call will fail to indicate you should follow the oAuth flow with Monerium.
</Warning>

There are two results possible here: 

1. If the User is not registered with Monerium you will receive a `"success": true` and it will take 3+ mininutes (due to the delay module that verifies the signature and ownership of the address) for the new Monerium account to be created;
2. The user already has a Monerium profile, so we need to request access to it via an oAuth flow, in this case the request will fail as expected.

When your User already have a Monerium account, we need to redirect the user to a URL so they can allow GnosisPay to interact with
their existing account. So the `POST` will return a `422` error with the following body:

```json
{
  errors: {
    externalApiCallStatusCode: 304,
    message: "User needs to be redirect to Monerium oAuth flow",
    redirectUrl: "... url ...",
  },
}
```

You need to redirect your users when `externalApiCallStatusCode == 304`.
After the User approves our access to their existing account, the background job will pick up from there and user will be redirected to the provided callback URL.

Another way to get the redirect URL if user has Monerium profile already is to use the `/api/v1/ibans/oauth/redirect_url` endpoint.

<Note>
`callbackUrl` should always be sent as query parameter in both the cases.
</Note>

</Step>
<Step title="Get the IBAN number, BIC, Status and Connected Blockchain Address where funds are sent">

[You should monitor this endpoint until you see a status of `ASSIGNED`](/api-reference/iban/retrieve-iban-details):

```bash cURL
curl -X GET /api/v1/ibans/details
```

Use this data to cash-in to your GnosisPay Account.

| IBAN Status | Description | Action |
| ------------- | -------------- | -------------- |
| NOTSTARTED | Initial state when the user hasn't started the IBAN creation process yet | User needs to initiate the IBAN creation process |
| PENDING | IBAN creation has been initiated and is being processed by Monerium | Wait for the process to complete, periodically check the status |
| PENDING_OAUTH | User has an existing Monerium profile and needs to authorize GnosisPay via OAuth | Redirect the user to the OAuth URL provided in the response |
| ASSIGNED | IBAN has been successfully created and assigned to the user | IBAN is ready to use for cash-in transactions |
</Step>
<Step title="Get the IBAN Statement (Orders list)">

To get a complete statement for the orders processed through IBAN:

```bash cURL
curl -X GET /api/v1/ibans/orders
```

<Note>
This endpoint returns only incoming orders (deposits) to the user's IBAN.
</Note>
</Step>
</Steps>


## Signing Example

The API works with any wallet and eliminates the need for specialized dependencies:

```typescript
// Step 1: Get complete typed data
const response = await fetch('/api/v1/ibans/transaction-data', {
  headers: { 'Authorization': `Bearer ${token}` }
});
const typedData = await response.json();

// Step 2: Sign directly with any wallet
const signature = await wallet.signTypedData(typedData.data);

// Step 3: Submit raw signature
await fetch('/api/v1/ibans/new-profile', {
  method: 'POST',
  headers: { 
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    signature,
    callbackUrl: 'https://your-app.com/iban-callback'
  })
});
```